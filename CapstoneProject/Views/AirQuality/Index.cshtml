@model CapstoneProject.Models.LatLngViewModel

@{
    ViewBag.Title = "Index";
}

<br />
<br />
<div id='map' style='height:500px; width:100%' />
<script src=@ViewBag.Url></script>
@*<script type="text/javascript" charset="utf-8">
    (function (w, d, t, f) {
        w[f] = w[f] || function (c, k, n) {
            s = w[f], k = s['k'] = (s['k'] || (k ? ('&k=' + k) : '')); s['c'] =
                c = (c instanceof Array) ? c : [c]; s['n'] = n = n || 0; L = d.createElement(t), e = d.getElementsByTagName(t)[0];
            L.async = 1; L.src = '//feed.aqicn.org/feed/' + (c[n].city) + '/' + (c[n].lang || '') + '/feed.v1.js?n=' + n + k;
            e.parentNode.insertBefore(L, e);
        };
    })(window, document, 'script', '_aqiFeed');
</script>*@

@*<span id="city-aqi-container"></span>

<script type="text/javascript" charset="utf-8">
    _aqiFeed({ container: "city-aqi-container", city: "London" });
</script>*@
<div style='%style;max-width:180px;text-align:center;'><small>%cityname AQI:</small> <div style='font-size:88px;height:60px;padding-top:30px;'>%aqiv</div> %impact</div>

<script>
    var map = new google.maps.Map(document.getElementById('map'), {
        center: new google.maps.LatLng(51.505, -0.09),
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        zoom: 12
    });
    @foreach (var lat in Model.Lat)
    {
        foreach (var lng in Model.Lng)
        {
            <text>var marker = new google.maps.Marker({
                    position: new google.maps.LatLng(@lat, @lng),
                    label: "H",
                    map: map
    });</text>
            Model.Lng.RemoveAt(0);
            break;
        };
    };


    var waqiMapOverlay = new google.maps.ImageMapType({
        getTileUrl: function (coord, zoom) {
            return 'https://tiles.aqicn.org/tiles/usepa-aqi/' + zoom + "/" + coord.x + "/" + coord.y + ".png?token=5422120c5e5008629c1d2e647e006b1a9d124514";
        },
        name: "Air  Quality",
    });

    map.overlayMapTypes.insertAt(0, waqiMapOverlay);

</script>

